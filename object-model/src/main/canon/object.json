{
	"canon": "0.0.1",
	"info": {
		"title": "Symphony 2.0 Authentication Service Model",
		"license": {
			"name": "Private"
		}
	},
	"id": "com.symphony.s2.model.object",
  "version": "1.0",
	"basePath": "/object/v1",
	"model": {
		"javaGenPackage": "com.symphony.oss.models.object.canon",
		"javaFacadePackage": "com.symphony.oss.models.object.canon.facade"
	},
  "methods": {
    "/objects/{objectHash}": {
      "parameters": {
        "objectHash": {
          "in": "path",
          "required": true,
          "description": "The id of the object.",
          "schema": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/Hash"
          }
        },
        "traceContextHash": {
          "in": "query",
          "required": false,
          "description": "The id of the trace context of which this operation is a part",
          "schema": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/Hash"
          }
        }
      },
      "get": {
        "summary": "Read an object",
        "operationId": "getObject",
        "tags": [
          "objects"
        ],
        "parameters": {
          "currentVersion": {
            "in": "query",
            "required": false,
            "description": "If true then the hash is a baseHash and we return the current version, otherwise the hash is an absoluteHash and we return that absolute version.",
            "schema": {
              "type": "boolean"
            }
          }
        },
        "response": {
          "required": false,
          "schema": {
            "$ref": "#/components/schemas/ObjectPayload"
          }
        }
      },
      "put": {
        "summary": "Create an object",
        "operationId": "createObjects",
        "tags": [
          "objects"
        ],
        "payload": {
          "required": true,
          "schema": {
            "$ref": "#/components/schemas/ObjectPayload"
          }
        }
      }
    },
    "/partitions/{partitionKey}/{sortKey}": {
      "parameters": {
        "partitionKey": {
          "in": "path",
          "description": "Partition Key Value",
          "required": true,
          "schema": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/Hash"
          }
        },
        "sortKey": {
          "in": "path",
          "description": "Sort Key Value",
          "required": true,
          "schema": {
            "$ref": "#/components/schemas/SortKey"
          }
        }
      },
      "get": {
        "summary": "Fetch the given object.",
        "operationId": "fetchObject",
        "response": {
          "required": true,
          "multiple": false,
          "schema": {
            "$ref": "#/components/schemas/ObjectPayload"
          }
        }
      }
    },
    "/partitions/upsert": {
      "parameters": {
      },
      "post": {
        "summary": "Upsert a partition",
        "operationId": "upsertPartition",
        "tags": [
          "partitions"
        ],
        "payload": {
          "required": true,
          "multiple": false,
          "schema": {
            "$ref": "#/components/schemas/UpsertPartitionRequest"
          }
        },
        "response": {
          "required": true,
          "multiple": false,
          "schema": {
            "$ref": "#/components/schemas/Partition"
          }
        }
      }
    }
  },
	"components": {
		"schemas": {
      "#PartitionKey": {
        "description": "A partition key.",
        "type": "string",
        "facade": true
      },
      "SortKey": {
        "description": "A sort key.",
        "type": "string",
        "facade": true
      },
      "IdObject": {
        "description": "An ID object, applications define IDs as a sub-type of this.",
        "type": "object",
        "extends": "https://models.oss.symphony.com/core.json#/components/schemas/ApplicationPayload",
        "facade": true,
        "required": [
          "hashType"
        ],
        "properties": {
          "hashType": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/HashType"
          },
          "sortKey": {
            "type": "string"
          }
        }
      },
      "UserIdObject": {
        "description": "An ID object belonging to a user.",
        "type": "object",
        "extends": "#/components/schemas/IdObject",
        "required": [
          "userId"
        ],
        "properties": {
          "userId": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/PodAndUserId"
          }
        }
      },
      "NamedUserIdObject": {
        "description": "An ID object for a named object belonging to a user.",
        "type": "object",
        "extends": "#/components/schemas/UserIdObject",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string"
          }
        }
      },
      "ObjectPayload": {
        "type": "object",
        "extends": "https://models.oss.symphony.com/core.json#/components/schemas/ApplicationPayload",
        "facade": true,
        "builderFacade": false,
        "description": "Base type for objects in the object store.",
        "required": [
          "partitionHash",
          "sortKey",
          "hashType"
        ],
        "properties": {
          "partitionHash": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/Hash"
          },
          "sortKey": {
            "$ref": "#/components/schemas/SortKey"
          },
          "hashType": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/HashType"
          },
          "baseHash": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/Hash"
          },
          "prevHash": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/Hash"
          },
          "prevSortKey": {
            "$ref": "#/components/schemas/SortKey"
          },
          "purgeDate": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/Instant"
          },
          "header": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/ApplicationPayload"
          },
          "encryptedPayload": {
            "$ref": "https://models.oss.symphony.com/crypto.json#/components/schemas/EncryptedData"
          },
          "cipherSuiteId": {
            "$ref": "https://models.oss.symphony.com/crypto.json#/components/schemas/CipherSuiteId"
          },
          "threadId": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/ThreadId"
          },
          "rotationId": {
              "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/RotationId"
          }
        }
      },
      "Partition": {
        "type": "object",
        "extends": "https://models.oss.symphony.com/core.json#/components/schemas/ApplicationPayload",
        "facade": true,
        "builderFacade": false,
        "description": "A partition in the object store.",

        "properties": {
          "id": {
            "$ref": "#/components/schemas/UserIdObject"
          }
        }
      },
      "PartitionThread": {
        "type": "object",
        "extends": "https://models.oss.symphony.com/core.json#/components/schemas/ApplicationPayload",
        "facade": true,
        "builderFacade": false,
        "description": "A partition in the object store.",

        "properties": {
          "partitionId": {
            "$ref": "#/components/schemas/UserIdObject"
          },
          "threadId": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/ThreadId"
          }
        }
      },
      "UpsertPartitionRequest": {
        "type": "object",
        "description": "Request to upsert a partition in the object store.",

        "properties": {
          "partitionId": {
            "$ref": "#/components/schemas/UserIdObject"
          },
          "threadIds": {
            "type": "array",
            "x-canon-cardinality": "SET",
            "items": {
              "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/ThreadId"
            }
          }
        }
      },
      "AffectedUsers": {
        "type": "object",
        "extends": "https://models.oss.symphony.com/core.json#/components/schemas/ApplicationPayload",
        "facade": false,
        "builderFacade": false,
        "description": "Header type for objects in the  object store.",

        "properties": {
          "requestingUser": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/PodAndUserId"
          },
          "affectedUsers": {
            "type": "array",
            "x-canon-cardinality": "SET",
            "items": {
              "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/PodAndUserId"
            }
          },
          "podId": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/PodId"
          },
          "effectiveDate": {
            "$ref": "https://models.oss.symphony.com/core.json#/components/schemas/Instant"
          }
        }
      }
    }
	}
}
